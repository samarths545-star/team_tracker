<!DOCTYPE html>
<html>
<head>
<title>Attorney Dashboard</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
<div class="container mt-4">
<h2>Firm Performance Analytics</h2>
<hr>

{% if data %}

<table class="table table-bordered text-center">
<tr class="table-dark">
<th>Rank</th>
<th>Employee</th>
<th>Calls</th>
<th>Call Minutes</th>
<th>Faxes</th>
<th>Records</th>
<th>Score</th>
</tr>

{% for row in data %}
<tr>
<td>{{ row.Rank }}</td>
<td>{{ row.employee }}</td>
<td>{{ row.total_calls }}</td>
<td>{{ row.call_minutes|round(1) }}</td>
<td>{{ row.total_faxes }}</td>
<td>{{ row.records_received }}</td>
<td class="fw-bold text-primary">{{ row.score|round(2) }}</td>
</tr>
{% endfor %}
</table>

<canvas id="chart"></canvas>

<script>
const labels = [{% for row in data %}"{{ row.employee }}",{% endfor %}];
const scores = [{% for row in data %}{{ row.score }},{% endfor %}];

new Chart(document.getElementById("chart"),{
type:"bar",
data:{labels:labels,datasets:[{label:"Performance Score",data:scores}]}
});
</script>

{% else %}
<div class="alert alert-warning">No analytics yet.</div>
{% endif %}

</div>
</body>
</html>